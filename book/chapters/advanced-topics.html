
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Advanced topics Â· CLI11 Tutorial</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        <meta name="author" content="Henry Schreiner">
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-term/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-hints/plugin-hints.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="internals.html" />
    
    
    <link rel="prev" href="toolkits.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="installation.html">
            
                <a href="installation.html">
            
                    
                    Installation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="basics.html">
            
                <a href="basics.html">
            
                    
                    Basics
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="flags.html">
            
                <a href="flags.html">
            
                    
                    Flags
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="options.html">
            
                <a href="options.html">
            
                    
                    Options
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="validators.html">
            
                <a href="validators.html">
            
                    
                    Validators
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="subcommands.html">
            
                <a href="subcommands.html">
            
                    
                    Subcommands and the App
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="an-advanced-example.html">
            
                <a href="an-advanced-example.html">
            
                    
                    An advanced example
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="config.html">
            
                <a href="config.html">
            
                    
                    Configuration files
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10" data-path="formatting.html">
            
                <a href="formatting.html">
            
                    
                    Formatting help output
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11" data-path="toolkits.html">
            
                <a href="toolkits.html">
            
                    
                    Toolkits
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.12" data-path="advanced-topics.html">
            
                <a href="advanced-topics.html">
            
                    
                    Advanced topics
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13" data-path="internals.html">
            
                <a href="internals.html">
            
                    
                    Internals
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Advanced topics</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="advanced-topics">Advanced topics</h1>
<h2 id="environment-variables">Environment variables</h2>
<p>Environment variables can be used to fill in the value of an option:</p>
<pre><code class="lang-cpp"><span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> opt;
app.add_option(<span class="hljs-string">&quot;--my_option&quot;</span>, opt)-&gt;envname(<span class="hljs-string">&quot;MY_OPTION&quot;</span>);
</code></pre>
<p>If not given on the command line, the environment variable will be checked and read from if it exists. All the standard tools, like default and required, work as expected.
If passed on the command line, this will ignore the environment variable.</p>
<h2 id="needsexcludes">Needs/excludes</h2>
<p>You can set a network of requirements. For example, if flag a needs flag b but cannot be given with flag c, that would be:</p>
<pre><code class="lang-cpp"><span class="hljs-keyword">auto</span> a = app.add_flag(<span class="hljs-string">&quot;-a&quot;</span>);
<span class="hljs-keyword">auto</span> b = app.add_flag(<span class="hljs-string">&quot;-b&quot;</span>);
<span class="hljs-keyword">auto</span> c = app.add_flag(<span class="hljs-string">&quot;-c&quot;</span>);

a-&gt;needs(b);
a-&gt;excludes(c);
</code></pre>
<p>CLI11 will make sure your network of requirements makes sense, and will throw an error immediately if it does not.</p>
<h2 id="custom-option-callbacks">Custom option callbacks</h2>
<p>You can make a completely generic option with a custom callback. For example, if you wanted to add a complex number (already exists, so please don&apos;t actually do this):</p>
<pre><code class="lang-cpp">CLI::<span class="hljs-function">Option *
<span class="hljs-title">add_option</span><span class="hljs-params">(CLI::App &amp;app, <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> name, cx &amp;variable, <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> description = <span class="hljs-string">&quot;&quot;</span>, <span class="hljs-keyword">bool</span> defaulted = <span class="hljs-literal">false</span>)</span> </span>{
    CLI::<span class="hljs-keyword">callback_t</span> fun = [&amp;variable](CLI::<span class="hljs-keyword">results_t</span> res) {
        <span class="hljs-keyword">double</span> x, y;
        <span class="hljs-keyword">bool</span> worked = CLI::detail::lexical_cast(res[<span class="hljs-number">0</span>], x) &amp;&amp; CLI::detail::lexical_cast(res[<span class="hljs-number">1</span>], y);
        <span class="hljs-keyword">if</span>(worked)
            variable = cx(x, y);
        <span class="hljs-keyword">return</span> worked;
    };

    CLI::Option *opt = app.add_option(name, fun, description, defaulted);
    opt-&gt;set_custom_option(<span class="hljs-string">&quot;COMPLEX&quot;</span>, <span class="hljs-number">2</span>);
    <span class="hljs-keyword">if</span>(defaulted) {
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">stringstream</span> out;
        out &lt;&lt; variable;
        opt-&gt;set_default_str(out.str());
    }
    <span class="hljs-keyword">return</span> opt;
}
</code></pre>
<p>Then you could use it like this:</p>
<pre><code>std::complex&lt;double&gt; comp{0, 0};
add_option(app, &quot;-c,--complex&quot;, comp);
</code></pre><h2 id="custom-converters">Custom converters</h2>
<p>You can add your own converters to allow CLI11 to accept more option types in the standard calls. These can only be used for &quot;single&quot; size options (so complex, vector, etc. are a separate topic). If you set up a custom <code>istringstream&amp; operator &lt;&lt;</code> overload before include CLI11, you can support different conversions. If you place this in the CLI namespace, you can even keep this from affecting the rest of your code. Here&apos;s how you could add <code>boost::optional</code> for a compiler that does not have <code>__has_include</code>:</p>
<pre><code class="lang-cpp"><span class="hljs-comment">// CLI11 already does this if __has_include is defined</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">ifndef</span> __has_include</span>

<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;boost/optional.hpp&gt;</span></span>

<span class="hljs-comment">// Use CLI namespace to avoid the conversion leaking into your other code</span>
<span class="hljs-keyword">namespace</span> CLI {

<span class="hljs-keyword">template</span> &lt;<span class="hljs-keyword">typename</span> T&gt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">istringstream</span> &amp;<span class="hljs-keyword">operator</span>&gt;&gt;(<span class="hljs-built_in">std</span>::<span class="hljs-built_in">istringstream</span> &amp;in, boost::optional&lt;T&gt; &amp;val) {
    T v;
    in &gt;&gt; v;
    val = v;
    <span class="hljs-keyword">return</span> in;
}

}

<span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span>

<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;CLI11.hpp&gt;</span></span>
</code></pre>
<p>This is an example of how to use the system only; if you are just looking for a way to activate <code>boost::optional</code> support on older compilers, you should define <code>CLI11_BOOST_OPTIONAL</code> before including a CLI11 file, you&apos;ll get the <code>boost::optional</code> support.</p>
<h2 id="custom-converters-and-type-names-stdchrono-example">Custom converters and type names: std::chrono example</h2>
<p>An example of adding a custom converter and typename for <code>std::chrono</code> follows:</p>
<pre><code class="lang-cpp"><span class="hljs-keyword">namespace</span> CLI
{
    <span class="hljs-keyword">template</span> &lt;<span class="hljs-keyword">typename</span> T, <span class="hljs-keyword">typename</span> R&gt;
    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">istringstream</span> &amp;<span class="hljs-keyword">operator</span>&gt;&gt;(<span class="hljs-built_in">std</span>::<span class="hljs-built_in">istringstream</span> &amp;in, <span class="hljs-built_in">std</span>::chrono::duration&lt;T,R&gt; &amp;val)
    {
        T v;
        in &gt;&gt; v;
        val = <span class="hljs-built_in">std</span>::chrono::duration&lt;T,R&gt;(v);
        <span class="hljs-keyword">return</span> in;
    }

    <span class="hljs-keyword">template</span> &lt;<span class="hljs-keyword">typename</span> T, <span class="hljs-keyword">typename</span> R&gt;
    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">stringstream</span> &amp;<span class="hljs-keyword">operator</span>&lt;&lt;(<span class="hljs-built_in">std</span>::<span class="hljs-built_in">stringstream</span> &amp;in, <span class="hljs-built_in">std</span>::chrono::duration&lt;T,R&gt; &amp;val)
    {
        in &lt;&lt; val.count();
        <span class="hljs-keyword">return</span> in;
    }
 }

<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;CLI/CLI.hpp&gt;</span></span>

<span class="hljs-keyword">namespace</span> CLI
{
    <span class="hljs-keyword">namespace</span> detail
    {
        <span class="hljs-keyword">template</span> &lt;&gt;
        <span class="hljs-keyword">constexpr</span> <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *type_name&lt;<span class="hljs-built_in">std</span>::chrono::hours&gt;()
        {
            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;TIME [H]&quot;</span>;
        }

        <span class="hljs-keyword">template</span> &lt;&gt;
        <span class="hljs-keyword">constexpr</span> <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *type_name&lt;<span class="hljs-built_in">std</span>::chrono::minutes&gt;()
        {
            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;TIME [MIN]&quot;</span>;
        }
        }
}
</code></pre>
<p>Thanks to Olivier Hartmann for the example.</p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="toolkits.html" class="navigation navigation-prev " aria-label="Previous page: Toolkits">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="internals.html" class="navigation navigation-next " aria-label="Next page: Internals">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Advanced topics","level":"1.12","depth":1,"next":{"title":"Internals","level":"1.13","depth":1,"path":"chapters/internals.md","ref":"chapters/internals.md","articles":[]},"previous":{"title":"Toolkits","level":"1.11","depth":1,"path":"chapters/toolkits.md","ref":"chapters/toolkits.md","articles":[]},"dir":"ltr"},"config":{"plugins":["include-codeblock","term","hints"],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"search":{},"term":{"copyButtons":true,"fade":true,"lineStyles":true,"prompt":"(?<prompt>[^\\$^#^:]*)(?<pathsep>:?)(?<path>[^\\$^#]*?)(?<delimiter>[\\$#] )(?<command>.*)$","style":"default"},"hints":{"danger":"fa fa-exclamation-circle","info":"fa fa-info-circle","tip":"fa fa-mortar-board","working":"fa fa-wrench"},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"fontsettings":{"theme":"white","family":"sans","size":2},"highlight":{},"include-codeblock":{"check":false,"edit":false,"fixlang":true,"lang":"","template":"default","theme":"chrome","unindent":true},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","author":"Henry Schreiner","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"CLI11 Tutorial","gitbook":"*","description":"A set of examples and detailed information about CLI11"},"file":{"path":"chapters/advanced-topics.md","mtime":"2021-04-05T17:33:33.941Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2021-04-05T17:37:59.972Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-term/clipboard.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-term/initclip.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-term/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

